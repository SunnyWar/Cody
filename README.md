# Cody: The AI-Authored Chess Engine

![Cody icon](chesscat256.ico)

Cody is an experimental chess engine where every line of code is generated by AI. The goal is to push LLM-assisted programming and answer one question: how strong of a chess engine can AI build from scratch?

## üöÄ Philosophy

Unlike traditional engines (like Stockfish) or NNUE-based engines tuned by humans, Cody is a "Zero-Human-Code" project.

- **Architecture and logic:** All search algorithms, evaluation functions, and bitboard manipulations are AI-generated.
- **Debugging:** Human intervention is limited to providing error logs back to the AI for self-correction.
- **Goal:** Achieve a competitive ELO rating with a codebase birthed from prompt engineering.

## üõ† Features (Current Status)

- **Bitboard representation:** High-performance board state management.
- **UCI protocol support:** Works with standard chess GUIs like Arena, Cute Chess, or Scid vs. PC.
- **Search algorithms:**
  - Negamax with alpha-beta pruning.
  - Iterative deepening.
  - Quiescence search to avoid the horizon effect.
- **Evaluation:** AI-crafted heuristics, including piece-square tables (PST) and material imbalance weights.

## üß† How Cody Learns

Cody uses a recursive feedback loop when the agent attempts a code improvement:

1. **Hypothesize:** The LLM suggests a chess logic improvement (e.g., "Implement Null Move Pruning").
2. **Execute:** The orchestrator applies the patch.
3. **Verify:** The local environment runs `cargo test`.
4. **Refine:** If tests fail, Cody analyzes the compiler error and self-corrects.

## üß™ Orchestrator Setup (Cloud)

Set environment variables:

```powershell
SET OPENAI_KEY="OPENAI_API_KEY"
SET GITHUB_TOKEN="GITHUB_TOKEN"
```

## üè† Running Locally (Zero Cost and Private)

If you want to run Cody's improvement orchestrator without an OpenAI account, you can use **Ollama**.

1. **Install Ollama:** Download from [ollama.com](https://ollama.com/).
2. **Pull a model:**
   ```bash
   ollama pull deepseek-coder-v2:16b-lite-instruct-q4_K_M
   ```
3. **Local configuration:** In `cody-agent/config.json`, set `"use_local": true`.
4. **No API key needed:** When `use_local` is true, the agent uses a placeholder key to bypass the OpenAI login requirement.

Start the server: ensure Ollama is running (it usually starts automatically in the system tray).

Configure the orchestrator in `cody-agent/config.json`:

```json
{
  "branch_prefix": "ai-feature-",
  "model": "deepseek-coder-v2:16b-lite-instruct-q4_K_M",
  "api_base": "http://localhost:11434/v1",
  "use_local": true
}
```

## ‚ñ∂Ô∏è Run the Orchestrator

From the repo root, choose one of the following:

```powershell
./run_orchestrator.ps1
```

```powershell
python .\cody-agent\orchestrator.py
```

## Human TODO Items
0. **Essential baseline functionality - human directs AI to add these features.**
   - command line not blocked by search - uci commands should be recieved and handled
   - UCI Command: debug [on | off] 
   - UCI Command: setoption name Hash value <x>
   - UCI Command: setoption name Clear Hash
   - UCI Command: go ponder Starts searching in "hint" mode on the opponent's time.
   - UCI Command: go nodes <x>
   - UCI Command: go mate <x>
   - UCI Command: go searchmoves <move1> ... <moveN> 
   - UCI Command: ponderhit
   - UCI Command: info seldepth <x> (Output command)
   - UCI Command: info nps <x> (Output command)
   - UCI Command: info hashfull <x> (Output command)
1. **PGO optimization**
   - Add a PGO build profile.
   - Add a PGO workflow.
   - Add a PGO training harness.
   - Add a PGO FEN suite.
   - Add a PGO merge rule ("only merge if PGO improves speed").
2. **Parameter tuning**
   - A parameter registry.
   - A tuning harness.
   - A tuning dataset.
   - A tuning workflow.
3. **SPRT testing**
   - Pick a harness.
   - Configure it.
   - Register machines.
4. **Strong AI evaluation (premium models)**
   - Secure funding.
5. **Tune orchestration**
   - Log summary of things tried, only allow retry after signifant code changes

## üõ† License

MIT License. See [LICENSE](LICENSE) for details.
